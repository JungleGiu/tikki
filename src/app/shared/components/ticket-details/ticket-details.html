@if (isVisible()) {
<div class="overlay-modal">
  <div class="modal">
    <header>
      <button class="close" (click)="isVisible.set(false)">X</button>
      <h3>{{ ticket.title }}</h3>
      <p>{{ ticket.description }}</p>
    </header>
    <div class="modal-body">
      @if (!editMode()) {
      <div class="categories">
        <span>Department:</span
        ><app-badge [variant]="ticket.department_id | departmentPipe"
          >Department: {{ ticket.department_id | departmentPipe }}</app-badge
        >

        <span>Priority:</span
        ><app-badge [variant]="ticket.priority | priority">{{
          ticket.priority | priority
        }}</app-badge>
      </div>
      <p><span>Deadline:</span> {{ ticket.deadline | date }}</p>
      <p><span>Location: </span>{{ ticket.location.name }}</p>
      <p><span>Created By:</span> {{ ticket.created_by | userName }}</p>
      <p><span>Created At:</span> {{ ticket.created_at | date }}</p>
      <p><span>Assigned To:</span> {{ ticket.assigned_to | userName }}</p>
      <p><span>Resolved At:</span> {{ ticket.resolved_at | date }}</p>
      <p><span>Status:</span> {{ ticket.status | status }}</p>
      <p>Attached: {{ ticket.attached }}</p>
      } @if (editMode()) {
      <form [formGroup]="editForm">
        <div class="field">
          <label for="priority">Priority</label>
          <select id="priority" formControlName="priority">
            <option value="" disabled>Select Priority</option>
            @for (option of priorityOptions; track option.value) {
            <option [value]="option.value.toString()">{{ option.label }}</option>
            }
          </select>
        </div>
        <div class="field">
          <label for="deadline">Deadline</label>
          <input type="date" id="deadline" formControlName="deadline" />
        </div>
        <div class="field">
          <app-location-input
            (newLocation)="onLocationSelected($event)"
            [location]="ticket.location"
          ></app-location-input>
        </div>
        <div class="field">
          <label for="assigned_to">Assigned To</label>
          <input type="number" id="assigned_to" formControlName="assigned_to" />
        </div>
        <div class="field">
          <label for="status">Status</label>
          <select id="status" formControlName="status">
            <option value="" disabled>Select Status</option>
            @for (option of statusOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
        </div>
      </form>
      }
    </div>
    <div class="modal-footer">
      @if (!editMode()) {
      <button (click)="editMode.set(true)">Edit</button>
      } @if (editMode()) {
      <button (click)="editMode.set(false)">Cancel</button>
      <button (click)="onEditSubmit()">Save</button>
      }
      <button (click)="deleteDialog.set(true)">Delete</button>
    </div>
  </div>
</div>
} @if (deleteDialog()) {

<app-confirm-delete-dialog
  (cancel)="deleteDialog.set(false)"
  (confirm)="onDelete($event)"
  [id]="ticket.id"
  [item]="'ticket'"
></app-confirm-delete-dialog>

}
